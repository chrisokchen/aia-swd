# 變更影響分析報告：新增回答投票與意見回饋功能

## 1. 需求概述

根據需求，需在每則回答下方新增「這個回答有幫助嗎？」的投票區塊，讓使用者可點選「是」或「否」。若點選「否」，需彈出意見回饋輸入框，請用戶提供建議。

---

## 2. 影響模組與檔案

### 主要影響模組
- `ChatContent`（訊息渲染區，需插入投票區塊）
- `TrayWindow`（主組件，若需狀態提升）
- `messagebar_new/MsgBar.tsx`（如需傳遞 props 或 callback）
- `messagebar_new` 目錄下新增/修改 UI 元件（如 Feedback、Modal）
- `src/css/AI_layout_format.css` 或 `messagebar.scss`（投票區塊與彈窗樣式）
- i18n 語言包（新增文案）

### 可能需新增的檔案
- `Feedback.tsx`：投票與意見回饋元件
- `FeedbackModal.tsx`：彈窗元件

---

## 3. 主要異動點與邏輯

### (1) ChatContent
- 每則回答訊息下方插入 <Feedback /> 區塊。
- 需能取得該則回答的唯一標識（如 index 或 id）。

### (2) Feedback 元件
- 顯示「這個回答有幫助嗎？」與「是」「否」按鈕。
- 點「否」時彈出意見輸入框（可用 Modal 實現）。
- 投票結果可本地記錄或送出 API（如有需求）。

### (3) 狀態管理
- 若意見回饋需跨組件傳遞，考慮將狀態提升至 TrayWindow 或使用 context。

### (4) 樣式
- 需於 `AI_layout_format.css` 或 `messagebar.scss` 增加投票區與彈窗樣式。

### (5) i18n
- 新增如「這個回答有幫助嗎？」「請提供您的寶貴意見」等文案。

---

## 4. 依賴關係
- ChatContent 需能渲染 Feedback 區塊。
- Feedback 需能觸發彈窗並回傳意見內容。
- 若需將回饋送出，需與後端 API 串接。

---

## 5. 已知挑戰與注意事項
- 回答訊息的唯一標識設計（避免投票混淆）。
- 彈窗體驗需流暢，避免阻斷用戶操作。
- 多語系文案需同步維護。
- 若需記錄投票/意見，需考慮 API 設計與權限。

---

## 6. 參考 UI
- 參考附件圖檔，投票區塊與彈窗設計。

---

## 7. 建議開發步驟
1. 設計 Feedback 與 FeedbackModal 元件。
2. 修改 ChatContent，於每則回答下方插入 Feedback。
3. 增加樣式與 i18n 文案。
4. 測試互動流程。
5. 若需串接 API，設計回饋資料結構與傳遞流程。

---

如需更詳細設計，請依上述分析進行。
